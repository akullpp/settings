#!/usr/bin/env bash
set -e
set -u
set -o pipefail

if [[ $# -eq 0 ]]; then
  echo "─────────────────────────────────────────────────────────────"
  lsof -i -P -n | rg LISTEN | sort -k2 -nr | awk '{printf "%-12s \033[31m%-8s\033[0m %-12s %s\n", $1, $2, $3, $9}' | column -t
  echo "─────────────────────────────────────────────────────────────"
else
  echo "─────────────────────────────────────────────────────────────"
  lsof -i -P -n | rg ":$1" | sort -k2 -nr | awk '{printf "%-12s \033[31m%-8s\033[0m %-12s %s\n", $1, $2, $3, $9}' | column -t
  echo "─────────────────────────────────────────────────────────────"
fi
